<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
    layout:decorate="~{layout/main}">

<head>
    <title th:text="${hotel.name} + ' - Chi ti·∫øt Kh√°ch s·∫°n'">Chi ti·∫øt Kh√°ch s·∫°n</title>
    
</head>

<body>
    <main layout:fragment="content">
        <div class="container py-4">
            <div class="row">
                <!-- Sidebar -->
                <div class="col-md-3">
                    <div class="sticky-top" style="top: 20px;">
                        <!-- ƒê·∫∑t ngay -->
                        <div class="card mb-4 border-primary">
                            <div class="card-body text-center">
                                <button class="btn btn-primary btn-lg w-100" onclick="scrollToRooms()">
                                    <i class="fas fa-calendar-check me-2"></i>ƒê·∫∑t ngay
                                </button>
                            </div>
                        </div>

                        <!-- Th√¥ng tin th√†nh ph·ªë -->
                        <div class="card mb-4">
                            <div class="position-relative">
                                <img th:src="@{${hotel.urlCityImage}}" class="card-img-top" alt="Th√†nh ph·ªë"
                                    style="height: 200px; object-fit: cover;">

                            </div>
                            <div class="card-body">
                                <p class="card-text">M·ªôt trong nh·ªØng khu v·ª±c ƒë·∫πp nh·∫•t ·ªü <span
                                        th:text="${hotel.cityName}">th√†nh ph·ªë</span></p>
                            </div>
                        </div>
                        <!-- ƒê√°nh gi√° -->
                        <div class="card">
                            <div class="card-body text-center">
                                <div class="rating-stars fs-2" th:text="${hotel.evaluate} + ' ‚òÖ'">5 ‚òÖ</div>
                                <p class="fw-bold text-primary mb-0" th:text="${hotel.evaluate == 0 ? 'B√¨nh th∆∞·ªùng' : 
                                       hotel.evaluate == 1 ? 'Kh√° ·ªïn' :
                                       hotel.evaluate == 2 ? 'Ch·∫•t l∆∞·ª£ng' :
                                       hotel.evaluate == 3 ? 'Sang tr·ªçng' :
                                       hotel.evaluate == 4 ? 'Tuy·ªát v·ªùi' : 'Xu·∫•t s·∫Øc'}">Xu·∫•t s·∫Øc</p>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- N·ªôi dung ch√≠nh -->
                <div class="col-md-9">
                    <!-- Header kh√°ch s·∫°n -->
                    <div class="d-flex justify-content-between align-items-start mb-4">
                        <div>
                            <h1 class="display-6 fw-bold" th:text="${hotel.name}">T√™n kh√°ch s·∫°n</h1>
                            <p class="text-primary mb-2">
                                <i class="fas fa-map-marker-alt me-2"></i>
                                <span th:text="${hotel.address}">ƒê·ªãa ch·ªâ</span>
                            </p>
                        </div>
                        <button class="btn btn-primary" onclick="scrollToRooms()">
                            <i class="fas fa-calendar-check me-2"></i>ƒê·∫∑t ngay
                        </button>
                    </div>

                    <!-- H√¨nh ·∫£nh kh√°ch s·∫°n -->
                    <div class="card mb-4">
                        <img th:src="@{'/images/KhachSan/' + ${hotel.id} + '.jpg'}" class="card-img-top" alt="Kh√°ch s·∫°n"
                            style="height: 400px; object-fit: cover;">
                    </div>

                    <!-- Th√¥ng tin kh√°ch s·∫°n -->
                    <div class="card mb-4">
                        <div class="card-body">
                            <div class="alert alert-warning" role="alert">
                                <i class="fas fa-star me-2"></i>
                                <strong>M·ªôt trong nh·ªØng ch·ªó ngh·ªâ thu·∫≠n ti·ªán cho vi·ªác tr·∫£i nghi·ªám nh·∫•t ·ªü <span
                                        th:text="${hotel.cityName}">th√†nh ph·ªë</span> c·ªßa ch√∫ng t√¥i!</strong>
                            </div>

                            <div class="row">
                                <div class="col-md-6">
                                    <p><strong>Lo·∫°i kh√°ch s·∫°n:</strong> <span
                                            th:text="${hotel.typeHotelName}">Lo·∫°i</span></p>
                                    <p><strong>Gi√°p bi·ªÉn:</strong> <span
                                            th:text="${hotel.nearSea == 1 ? 'C√≥' : 'Kh√¥ng'}">Kh√¥ng</span></p>
                                </div>
                                <div class="col-md-6">
                                    <p><strong>S·ªë ƒëi·ªán tho·∫°i:</strong> <span th:text="${hotel.phone}">0123456789</span>
                                    </p>
                                    <p><strong>ƒê√°nh gi√°:</strong>
                                        <span class="rating-stars" th:text="${hotel.evaluate} + ' ‚òÖ'">5 ‚òÖ</span>
                                    </p>
                                </div>
                            </div>

                            <div class="mt-3">
                                <h5>M√¥ t·∫£</h5>
                                <p th:text="${hotel.description}">M√¥ t·∫£ kh√°ch s·∫°n</p>
                            </div>
                        </div>
                    </div>

                    <!-- Ph√≤ng tr·ªëng -->
                    <div id="room-list" class="container py-3">
                        <h3 class="mb-4 text-left">
                            <i class="fas fa-door-open me-2"></i>Danh s√°ch ph√≤ng
                        </h3>

                        <!-- üîπ Form ki·ªÉm tra ph√≤ng tr·ªëng -->
                        <div class="card shadow-sm border-0 mb-4 bg-warning text-dark">
                            <div class="card-body">
                                <h5 class="mb-3 text-secondary">
                                    <i class="fas fa-calendar-alt me-2 text-primary"></i>
                                    B·∫°n mu·ªën ngh·ªâ t·∫°i
                                    <strong class="text-primary" th:text="${hotel.name}">kh√°ch s·∫°n</strong>
                                    v√†o l√∫c n√†o?
                                </h5>

                                <form th:action="@{/hotel/{id}/room-empty(id=${hotel.id})}" method="get"
                                    class="row g-3">
                                    <div class="col-md-4">
                                        <label for="ngayDen" class="form-label fw-bold text-secondary">Ng√†y nh·∫≠n
                                            ph√≤ng</label>
                                        <input type="date" class="form-control rounded-pill shadow-sm" id="ngayDen"
                                            name="ngayDen" th:value="${ngayDen}"
                                            th:min="${#temporals.format(#temporals.createNow(), 'yyyy-MM-dd')}"
                                            required>
                                    </div>

                                    <div class="col-md-4">
                                        <label for="ngayTra" class="form-label fw-bold text-secondary">Ng√†y tr·∫£
                                            ph√≤ng</label>
                                        <input type="date" class="form-control rounded-pill shadow-sm" id="ngayTra"
                                            name="ngayTra" th:value="${ngayTra}"
                                            th:min="${#temporals.format(#temporals.createNow(), 'yyyy-MM-dd')}"
                                            required>
                                    </div>

                                    <div class="col-md-4 d-flex align-items-end">
                                        <button type="submit" class="btn btn-primary w-100 rounded-pill py-2 shadow-sm">
                                            <i class="fas fa-search me-2"></i>Ki·ªÉm tra ph√≤ng tr·ªëng
                                        </button>
                                    </div>
                                </form>
                            </div>
                        </div>

                        <!-- üîπ Danh s√°ch ph√≤ng -->
                        <div class="card shadow-sm border-0" style="border-radius: 16px;">
                            <div class="card-body p-0">
                                <table class="table table-hover align-middle mb-0">
                                    <thead class="table-primary text-center">
                                        <tr>
                                            <th style="width: 15%;">S·ªë gi∆∞·ªùng</th>
                                            <th style="width: 30%;">Lo·∫°i ph√≤ng</th>
                                            <th style="width: 35%;">Ti·ªán √≠ch</th>
                                            <th style="width: 20%;">ƒê·∫∑t ph√≤ng</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr th:each="room : ${roomList}" class="border-bottom">
                                            <td class="text-center py-3">
                                                <i class="fas fa-bed fa-2x text-primary"></i><br>
                                                <small class="text-muted" th:text="${room.bed} + ' gi∆∞·ªùng'">1
                                                    gi∆∞·ªùng</small>
                                            </td>

                                            <td class="py-3">
                                                <h6 class="text-primary fw-bold mb-1" th:text="${room.name}">T√™n ph√≤ng
                                                </h6>
                                                <p class="mb-1 text-muted"><span th:text="${room.area}">0</span> m¬≤</p>
                                                <p class="fw-semibold text-success mb-0">
                                                    <span
                                                        th:text="${#numbers.formatInteger(room.price, 0, 'COMMA')}"></span>,000
                                                    VND/ƒë√™m
                                                </p>
                                            </td>

                                            <td class="text-start py-3">
                                                <div class="text-muted">
                                                    <div th:if="${room.amenities != null and !room.amenities.empty}"
                                                        th:each="am : ${room.amenities}"
                                                        class="mb-1 d-flex align-items-center">
                                                        <i class="fas fa-check text-success me-2"></i>
                                                        <span th:text="${am.name}"></span>
                                                    </div>

                                                    <div
                                                        th:unless="${room.amenities != null and !room.amenities.empty}">
                                                        <em class="text-muted">Ch∆∞a c√≥ ti·ªán √≠ch</em>
                                                    </div>
                                                </div>
                                            </td>

                                            <td class="text-center py-3">
                                                <button class="btn rounded-pill px-3"
                                                    th:classappend="${daKiemTraroomTrong ?: false} ? 'btn-primary' : 'btn-secondary'"
                                                    th:data-room-id="${room.id}"
                                                    th:disabled="${!(daKiemTraroomTrong ?: false)}"
                                                    onclick="bookRoom(this)">
                                                    <i class="fas fa-calendar-plus me-1"></i>ƒê·∫∑t Ph√≤ng
                                                </button>
                                            </td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>

                        <!-- üîπ Kh√¥ng c√≥ ph√≤ng tr·ªëng -->
                        <div class="text-center py-5" th:if="${roomList == null or roomList.empty}">
                            <i class="fas fa-bed fa-3x text-muted mb-3"></i>
                            <h4 class="text-muted">Kh√¥ng c√≥ ph√≤ng tr·ªëng</h4>
                            <p class="text-muted">Vui l√≤ng th·ª≠ l·∫°i v·ªõi ng√†y kh√°c</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <script>
        function scrollToRooms() {
            document.getElementById('room-trong').scrollIntoView({ behavior: 'smooth' });
        }

        function bookRoom(button) {
            const roomId = button.getAttribute('data-room-id');
            const ngayDen = document.getElementById('ngayDen').value;
            const ngayTra = document.getElementById('ngayTra').value;

            if (!ngayDen || !ngayTra) {
                alert('Vui l√≤ng ch·ªçn ng√†y nh·∫≠n v√† tr·∫£ ph√≤ng!');
                return;
            }

            if (confirm('B·∫°n c√≥ ch·∫Øc ch·∫Øn mu·ªën ƒë·∫∑t ph√≤ng n√†y kh√¥ng?')) {
                window.location.href = `/dat-room/${roomId}?ngayDen=${ngayDen}&ngayTra=${ngayTra}`;
            }
        }
    </script>
</body>

</html>