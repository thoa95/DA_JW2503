<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
	layout:decorate="~{layout/main}">

<head>
	<title>Giỏ Booking</title>
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css">
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css">

	<style>
		body {
			background-color: #f8fafc;
		}

		.cart-container {
			max-width: 950px;
			margin: 40px auto;
		}

		.cart-card {
			border: none;
			border-radius: 12px;
			box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
			background: white;
		}

		.table th {
			background-color: #0d6efd;
			color: white;
			text-align: center;
		}

		.table td {
			vertical-align: middle;
			text-align: center;
		}

		.total-box {
			font-size: 1.2rem;
			font-weight: 600;
			color: #15803d;
			text-align: right;
		}

		.btn-remove:hover {
			color: white;
			background-color: #dc3545;
		}

		.btn-clear:hover {
			color: white;
			background-color: #6c757d;
		}

		.empty-cart {
			text-align: center;
			padding: 60px 20px;
			color: #6c757d;
		}

		.empty-cart i {
			font-size: 60px;
			color: #adb5bd;
			margin-bottom: 20px;
		}
	</style>
</head>

<body layout:fragment="content">
	<div class="cart-container">
		<h2 class="mb-4 text-center text-primary">
			<i class="fas fa-cart-shopping me-2"></i>Giỏ Booking của bạn
		</h2>

		<div class="card cart-card p-4">
			<!-- Nếu giỏ trống -->
			<div class="empty-cart" th:if="${cartItems == null or #lists.isEmpty(cartItems)}">
				<i class="fas fa-cart-arrow-down"></i>
				<h5>Giỏ hàng trống</h5>
				<p>Hãy quay lại trang khách sạn để chọn phòng.</p>
				<a th:href="@{/hotel}" class="btn btn-primary mt-3">
					<i class="fas fa-bed me-1"></i>Quay lại khách sạn
				</a>
			</div>

			<!-- Nếu có dữ liệu -->
			<div th:if="${cartItems != null and !#lists.isEmpty(cartItems)}">
				<div class="table-responsive">
					<table class="table align-middle">
						<thead>
							<tr>
								<th>Tên phòng</th>
								<th>Giá / đêm</th>
								<th>Từ ngày</th>
								<th>Đến ngày</th>
								<th>Số ngày</th>
								<th>Thành tiền</th>
								<th>Thao tác</th>
							</tr>
						</thead>
						<tbody>
							<tr th:each="item : ${cartItems}">
								<form th:action="@{/cart/update}" method="post">
									<input type="hidden" name="roomId" th:value="${item.roomId}" />
									<td th:text="${item.roomName}"></td>

									<td>
										<span th:text="${#numbers.formatInteger(item.price, 0, 'COMMA')}"></span> VND
									</td>

									<td>
										<input type="date" name="fromDate" class="form-control"
											th:value="${item.fromDate}" required>
									</td>

									<td>
										<input type="date" name="toDate" class="form-control" th:value="${item.toDate}"
											required>
									</td>

									<td th:text="${item.numberDay}"></td>
									<td>
										<span
											th:text="${#numbers.formatInteger(item.price * item.numberDay, 0, 'COMMA')}"></span>
										VND
									</td>


									<td class="d-flex justify-content-center gap-2">
										<button type="submit" class="btn btn-outline-success btn-sm">
											<i class="fa fa-sync"></i> Cập nhật
										</button>
										<a th:href="@{'/cart/remove/' + ${item.roomId}}"
											class="btn btn-outline-danger btn-sm">
											<i class="fa fa-trash"></i> Xóa
										</a>
									</td>
								</form>
							</tr>
						</tbody>

					</table>
				</div>

				<div class="d-flex justify-content-between align-items-center mt-3">
					<a th:href="@{/cart/clear}" class="btn btn-outline-secondary">
						<i class="fas fa-trash"></i> Xóa toàn bộ
					</a>

					<p class="total-box mb-0">
						Tổng cộng:
						<span
							th:text="${totalPrice != null ? #numbers.formatInteger(totalPrice, 0, 'COMMA') + ' VND' : '—'}"></span>
					</p>
				</div>

				<div class="text-end mt-4">
					<a th:href="@{/checkout}" class="btn btn-success btn-lg">
						<i class="fas fa-credit-card me-2"></i>Tiến hành đặt phòng
					</a>
				</div>
			</div>
		</div>
	</div>



</body>

</html>