<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
	layout:decorate="~{layout/main}">

<head>
	<title th:text="${hotel.name} + ' - Chi tiết Khách sạn'">Chi tiết Khách sạn</title>

	<!-- Bootstrap + FontAwesome -->
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css">
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css">
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css" />

	<style>
		body {
			background-color: #f8fafc;
		}

		.sidebar-card img {
			height: 200px;
			object-fit: cover;
		}

		.sidebar-card .btn {
			border-radius: 25px;
		}

		.room-card img {
			height: 180px;
			object-fit: cover;
		}

		.room-card:hover {
			transform: translateY(-3px);
			box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
			transition: all 0.25s ease;
		}

		.badge-amenity {
			font-size: 0.75rem;
		}

		.price-box {
			font-weight: 700;
			color: #15803d;
			font-size: 1.1rem;
		}

		.btn-add:hover {
			transform: scale(1.05);
		}

		.btn-fixed-width {
			width: 150px;
		}


		.fade-in {
			animation: fadeIn 0.4s ease-in-out;
		}

		@keyframes fadeIn {
			from {
				opacity: 0;
				transform: translateY(-5px);
			}

			to {
				opacity: 1;
				transform: translateY(0);
			}
		}
	</style>

	<style>
		/* Màu nền ấm cho khối chọn ngày */
		.booking-section {
			background: rgb(192, 192, 192);
			border: 1px solid #f9d89a;
			box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
			transition: transform 0.3s ease, box-shadow 0.3s ease;
		}

		.booking-section:hover {
			transform: translateY(-3px);
			box-shadow: 0 8px 20px rgba(0, 0, 0, 0.12);
		}

		/* Nút màu amber ấm */
		.btn-gradient-amber {
			background: linear-gradient(90deg, #ffb347, #ffcc33);
			border: none;
			color: #4b2e05;
			font-weight: 600;
			transition: all 0.3s ease;
		}

		.btn-gradient-amber:hover {
			background: linear-gradient(90deg, #ffa41b, #ffbf00);
			transform: translateY(-1px);
			box-shadow: 0 4px 10px rgba(0, 0, 0, 0.15);
		}

		input[type="date"]:hover {
			border-color: #ffb347 !important;
		}

		input[type="date"]:focus {
			outline: none;
			box-shadow: 0 0 0 0.2rem rgba(255, 196, 61, 0.3);
		}
	</style>

	<style>
		.price-box {
			font-weight: 700;
			/* in đậm */
			font-size: 1.2rem;
			/* giảm từ 1.5rem xuống 1.2rem */
			color: #ff9800;
			/* cam nổi bật */
		}

		.animate-price {
			display: inline-block;
			animation: pulsePrice 1.2s ease-in-out infinite;
			/* giữ hiệu ứng phóng to/nhỏ nhẹ */
		}

		/* hiệu ứng scale nhẹ hơn */
		@keyframes pulsePrice {
			0% {
				transform: scale(1);
			}

			50% {
				transform: scale(1.05);
			}

			/* scale nhẹ, mềm mại */
			100% {
				transform: scale(1);
			}
		}
		
		
		.info-badge {
		    display: inline-block;
		    padding: 0.25rem 0.6rem;
		    border-radius: 12px;
		    font-weight: 600;
		    font-size: 0.875rem;
		    color: #fff;
		    transition: all 0.2s ease-in-out;
		}

		/* Badge riêng biệt cho giường */
		.bed-badge {
		    background: linear-gradient(135deg, #4f46e5, #6366f1); /* tím gradient */
		}

		/* Badge riêng biệt cho diện tích */
		.area-badge {
		    background: linear-gradient(135deg, #16a34a, #22c55e); /* xanh lá gradient */
	}

		/* Hover nhẹ tăng kích thước */
		.room-card:hover .info-badge {
		    transform: scale(1.05);
		    box-shadow: 0 2px 8px rgba(0,0,0,0.15);
		}

		
		.amenities {
		    display: flex;
		    flex-wrap: wrap;  /* nếu quá nhiều badge thì xuống dòng */
		    gap: 0.5rem;      /* khoảng cách giữa badge */
		}

		.amenity-badge {
		    display: inline-block;
		    padding: 0.25rem 0.6rem;
		    border-radius: 12px;
		    font-weight: 500;
		    font-size: 0.8rem;
		    color: #fff;
		    background: linear-gradient(135deg, #f97316, #fbbf24); /* cam gradient */
		    transition: all 0.2s ease-in-out;
		}

		/* Hover nhẹ badge tiện ích */
		.room-card:hover .amenity-badge {
		    transform: scale(1.05);
		    box-shadow: 0 2px 6px rgba(0,0,0,0.15);
		}
	</style>



</head>

<body>
	<main layout:fragment="content">
		<div class="container py-4">
			<div class="row">
				<!-- Sidebar trái -->
				<aside class="col-md-3 mb-4">
					<div class="sticky-top" style="top: 20px;">
						<div class="card sidebar-card mb-4 shadow-sm">
							<img th:src="@{'/images/KhachSan/' + ${hotel.id} + '.jpg'}" class="card-img-top"
								alt="Hotel" />
							<div class="card-body">
								<h5 class="card-title" th:text="${hotel.name}">Tên khách sạn</h5>
								<p><i class="fas fa-map-marker-alt"></i> <span th:text="${hotel.address}">Địa chỉ</span>
								</p>
								<p><i class="fas fa-star"></i> <span th:text="${hotel.evaluate} + ' ★'">5★</span></p>
								<p><i class="fas fa-phone"></i> <span th:text="${hotel.phone}">0123456789</span></p>
								<p><strong>Loại:</strong> <span th:text="${hotel.typeHotelName}">Resort</span></p>
								<p><strong>Gần biển:</strong> <span
										th:text="${hotel.nearSea == 1 ? 'Có' : 'Không'}">Không</span></p>
								<a class="btn btn-primary w-100 mt-3" th:href="@{/cart}">
									<i class="fas fa-calendar-check me-2"></i>Đặt ngay
								</a>
							</div>
						</div>


				</aside>

				<!-- Content phải -->

				<section class="col-md-9">
					<h2 style="text-align: center;">Danh sách phòng</h2>
					<!-- ✅ Form chọn ngày -->

					<div class="booking-section rounded-4 p-4 mb-4 shadow-sm" th:if="${!roomList.empty}">
						<h5 class="fw-bold text-dark mb-3">
							<i class="fas fa-calendar-alt me-2 text-primary"></i>Chọn ngày nghỉ
						</h5>

						<form th:action="@{/hotel/{id}/empty-room(id=${hotel.id})}" method="get"
							onsubmit="return validateDates()">
							<div class="row g-3 align-items-end">
								<!-- Ngày nhận -->
								<div class="col-md-4">
									<label for="fromDate" class="form-label fw-semibold text-dark small">
										<i class="fas fa-sign-in-alt me-1 text-primary"></i>Ngày nhận
									</label>
									<input type="date" class="form-control shadow-sm rounded-3 border-0" id="fromDate"
										name="fromDate" th:value="${fromDate}" required
										th:attr="min=${#dates.format(#dates.createNow(), 'yyyy-MM-dd')}">
								</div>

								<!-- Ngày trả -->
								<div class="col-md-4">
									<label for="toDate" class="form-label fw-semibold text-dark small">
										<i class="fas fa-sign-out-alt me-1 text-primary"></i>Ngày trả
									</label>
									<input type="date" class="form-control shadow-sm rounded-3 border-0" id="toDate"
										name="toDate" th:value="${toDate}" required
										th:attr="min=${#dates.format(#dates.createNow(), 'yyyy-MM-dd')}">
								</div>

								<!-- Nút kiểm tra -->
								<div class="col-md-4">
									<button type="submit"
										class="btn btn-gradient-amber w-100 rounded-3 shadow-sm py-2 mt-2">
										<i class="fas fa-search me-2"></i>Kiểm tra phòng trống
									</button>
								</div>
							</div>
						</form>
					</div>


					<div id="room-list" class="row g-4">
						<!-- Danh sách phòng -->
						<div th:each="room : ${roomList}" class="col-12 col-md-6 col-lg-4">
							<div class="card room-card h-100 shadow-sm d-flex flex-column">
								<img th:src="@{${room.urlImage}}" class="card-img-top" alt="Hình phòng" />
								<div class="card-body d-flex flex-column flex-grow-1">
									<!-- Thông tin phòng -->
									<h5 class="card-title" th:text="${room.name}">Tên phòng</h5>
									
									<div class="room-info d-flex gap-2 mb-2">
									    <span class="info-badge bed-badge" th:text="${room.bed} + ' giường'">1 giường</span>
									    <span class="info-badge area-badge" th:text="${room.area} + ' m²'">30 m²</span>
									</div>
									
									<!-- Tiện ích -->
									<div class="amenities mb-2 d-flex flex-wrap gap-2">
									    <span th:each="am : ${room.amenities}" 
									          class="amenity-badge" 
									          th:text="${am.name}">WiFi</span>
									</div>

									<!-- Giá phòng -->
									<div class="price-box mb-3 text-center animate-price mt-auto">
										<span th:text="${#numbers.formatInteger(room.price,0,'COMMA')}">500,000</span>
										VND/đêm
									</div>

									<!-- Nút Thêm giỏ -->
									<div class="d-flex justify-content-center">
										<button type="button" class="btn btn-sm btn-fixed-width add-to-cart-btn"
											th:data-room-id="${room.id}" th:data-room-name="${room.name}"
											th:data-price="${room.price}" th:data-from-date="${fromDate}"
											th:data-to-date="${toDate}"
											th:disabled="${checkedRooms == null or !checkedRooms}"
											th:classappend="${checkedRooms == null or !checkedRooms} ? ' btn-secondary' : ' btn-info text-dark'"
											th:title="${checkedRooms == null or !checkedRooms} ? 'Vui lòng chọn ngày nhận và trả phòng trước' : 'Thêm phòng vào giỏ hàng'">
											<i class="fas fa-cart-plus me-1"></i>Thêm giỏ
										</button>
									</div>
								</div>
							</div>

						</div>

						<!-- Nếu không có phòng -->
						<div class="col-12 text-center py-5" th:if="${roomList == null or roomList.empty}">
							<i class="fas fa-bed fa-3x text-muted mb-3"></i>
							<h4 class="text-muted">Không có phòng khả dụng</h4>
							<p class="text-muted">Thử lại với ngày khác</p>
						</div>
					</div>

					<!-- Phân trang -->
					<div class="mt-4" th:if="${roomPage != null and roomPage.totalPages >= 1}">
						<nav class="d-flex justify-content-center">
							<ul class="pagination">
								<li class="page-item" th:classappend="${roomPage.first}? 'disabled'">
									<a class="page-link"
										th:href="@{/hotel/{id}/empty-room(id=${hotel.id}, fromDate=${fromDate}, toDate=${toDate}, page=${roomPage.number - 1})}">«</a>
								</li>
								<li class="page-item" th:each="i : ${#numbers.sequence(0, roomPage.totalPages - 1)}"
									th:classappend="${i == roomPage.number}? 'active'">
									<a class="page-link" th:text="${i + 1}"
										th:href="@{/hotel/{id}/empty-room(id=${hotel.id}, fromDate=${fromDate}, toDate=${toDate}, page=${i})}"></a>
								</li>
								<li class="page-item" th:classappend="${roomPage.last}? 'disabled'">
									<a class="page-link"
										th:href="@{/hotel/{id}/empty-room(id=${hotel.id}, fromDate=${fromDate}, toDate=${toDate}, page=${roomPage.number + 1})}">»</a>
								</li>
							</ul>
						</nav>
					</div>
				</section>
			</div>
		</div>
	</main>

	<script>
		const fromInput = document.getElementById('fromDate');
		const toInput = document.getElementById('toDate');

		fromInput.addEventListener('change', () => {
			toInput.min = fromInput.value;
			if (toInput.value < fromInput.value) {
				toInput.value = fromInput.value;
			}
		});


		function scrollToRooms() {
			document.getElementById('room-list').scrollIntoView({behavior: 'smooth'});
		}

		function validateDates() {
			const fromDate = document.getElementById('fromDate').value;
			const toDate = document.getElementById('toDate').value;
			if (!fromDate || !toDate) {
				alert('Vui lòng chọn ngày nhận và trả phòng');
				return false;
			}
			if (fromDate > toDate) {
				alert('Ngày trả phải sau ngày nhận');
				return false;
			}
			return true;
		}
	</script>

</body>